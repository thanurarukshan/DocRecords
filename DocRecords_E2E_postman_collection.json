{
  "info": {
    "name": "DocRecords E2E Tests",
    "_postman_id": "12345-67890",
    "description": "E2E tests for DocRecords via API Gateway (http://localhost:4000)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Patient Signup",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "http://localhost:4000/auth/signup",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"fullName\": \"Test Patient\",\n  \"age\": 30,\n  \"gender\": \"male\",\n  \"birthday\": \"1995-01-01\",\n  \"mobile\": \"1234567890\",\n  \"email\": \"patient@test.com\",\n  \"password\": \"password\",\n  \"role\": \"patient\"\n}"
        }
      }
    },
    {
      "name": "Patient Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "let jsonData = pm.response.json();",
              "pm.environment.set(\"patientToken\", jsonData.token);",
              "pm.environment.set(\"patientId\", jsonData.user.id);"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "http://localhost:4000/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"patient@test.com\",\n  \"password\": \"password\",\n  \"role\": \"patient\"\n}"
        }
      }
    },
    {
      "name": "Fetch Patient Profile",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{patientToken}}" }
        ],
        "url": "http://localhost:4000/profile/users/{{patientId}}"
      }
    },
    {
      "name": "Doctor Signup",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "http://localhost:4000/auth/signup",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"fullName\": \"Test Doctor\",\n  \"age\": 40,\n  \"gender\": \"female\",\n  \"birthday\": \"1983-01-01\",\n  \"mobile\": \"9876543210\",\n  \"email\": \"doctor@test.com\",\n  \"password\": \"password\",\n  \"role\": \"doctor\",\n  \"mbbsReg\": \"MBBS123\"\n}"
        }
      }
    },
    {
      "name": "Doctor Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "let jsonData = pm.response.json();",
              "pm.environment.set(\"doctorToken\", jsonData.token);",
              "pm.environment.set(\"doctorId\", jsonData.user.id);"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "url": "http://localhost:4000/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"doctor@test.com\",\n  \"password\": \"password\",\n  \"role\": \"doctor\"\n}"
        }
      }
    },
    {
      "name": "Doctor Searches Patient",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{doctorToken}}" }
        ],
        "url": "http://localhost:4000/patient/patients/{{patientId}}"
      }
    },
    {
      "name": "Doctor Adds Prescription",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Authorization", "value": "Bearer {{doctorToken}}" },
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": "http://localhost:4000/prescription/add-prescription",
        "body": {
          "mode": "raw",
          "raw": "{\n  \"patient_id\": {{patientId}},\n  \"doctor_id\": {{doctorId}},\n  \"prescription\": \"Vitamin C 500mg\"\n}"
        }
      }
    },
    {
      "name": "Patient Views Medical History",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{patientToken}}" }
        ],
        "url": "http://localhost:4000/prescription/medical-history/{{patientId}}"
      }
    }
  ]
}
